### 浏览器解析URL
- 自动扩展URL
    浏览器在用户提交url时候，或者在用户尝试输入url时，浏览器会根据主机名与访问历史自动补全url。

- URL相对路径转换
    如果url是相对url，先要解析url相对引用，把相对url解析成绝对url路径。![解析详情][1]

- 解析URL
    把url解析成9部分组件
    - 组件名:说明:默认值
    1. 方案:协议:无
    2. 用户:访问特定资源需要的用户名:匿名
    3. 密码:用户名对应密码:<E-mail>地址
    4. 主机:IP地址或者域名:无
    5. 端口:资源服务器监听端口号:每个方案特有(http是80)
    6. 路径:url路径可以分为若干段,每段都有特有组件:无
    7. 参数:某些方案用这个组件指定输入参数.与路径之间用;分隔,格式:参数名/值对
    8. 查询:传递参数来激活应用程序.没有固定格式,用?与url其他部分分隔
    9. 片段:一小片或者一部分资源名.不会传递给服务器,用#与url其他部分分隔

- 转义URL
    url使用US-ASCII码来传输。当查询遇到一些特殊字符，如空格，汉字，特殊符号会经过浏览器编码转义。
    编码以%开头，后面接两个ASCII码的十六进制数。

### 中间介质
#### 网卡
#### 路由器
#### 交换机
#### 网关
#### 隧道
#### 中继

### 域名解析
如果解析主机是IP地址，省略此步骤。如果解析的主机是域名。会经过以下几个步骤：

- 浏览器搜索自身的DNS缓存,看是否有www.baidu.com对应的条目，如果有且没有过期则停止搜索解析到此结束。

- 如果没有找到对应的条目，那么浏览器会搜索操作系统的DNS缓存,如果找到且没过期则停止搜索解析到此结束.

- 如果在系统的DNS缓存也没有找到，那么尝试读取hosts文件，看有没有该域名对应的IP地址，如果有则停止搜索解析到此结束。

- 如果在hosts文件中也没有找到对应的条目，首先会找TCP/IP参数中设置的首选DNS服务器，在此我们叫它本地DNS服务器，此服务器收到查询时，如果要查询的域名，包含在本地配置区域资源中，则返回解析结果给客户机，完成域名解析，此解析具有权威性。

- 如果要查询的域名，不由本地DNS服务器区域解析，但该服务器已缓存了此网址映射关系，则调用这个IP地址映射，完成域名解析，此解析不具有权威性。

- 如果本地DNS服务器本地区域文件与缓存解析都失效，则根据本地DNS服务器的设置（是否设置转发器）进行查询，如果未用转发模式，本地DNS就把请求发至13台根DNS，根DNS服务器收到请求后会判断这个域名(.com)是谁来授权管理，并会返回一个负责该顶级域名服务器的一个IP。本地DNS服务器收到IP信息后，将会联系负责.com域的这台服务器。这台负责.com域的服务器收到请求后，如果自己无法解析，它就会找一个管理.com域的下一级DNS服务器地址(qq.com)给本地DNS服务器。当本地DNS服务器收到这个地址后，就会找qq.com域服务器，重复上面的动作，进行查询，直至找到www.qq.com主机。

- 如果用的是转发模式，此DNS服务器就会把请求转发至上一级DNS服务器，由上一级服务器进行解析，上一级服务器如果不能解析，或找根DNS或把转请求转至上上级，以此循环。不管是本地DNS服务器用是是转发，还是根提示，最后都是把结果返回给本地DNS服务器，由此DNS服务器再返回给客户机。

![域名映射][2]

拿到IP，端口号，开始发起请求。

### HTTP事物
##### 代理/反向代理(负载均衡)
- 代理
通过一台中介服务器来和远程服务器发送请求。比如用户与中介服务器，中介服务器与远程服务器的连接速度都很快，但是用户与远程服务器无法连接的情况。
    - 用户IP报文的目的IP = 代理服务器IP
    - 用户报文端口号 = 代理服务器监听端口号
    - HTTP消息里的URL要提供服务器的链接
    - 代理服务器可以根据服务器里的链接与服务器直接通信
    - 服务器返回给代理，代理返回给客户端

- 反向代理
用户和负载均衡设备直接通信，也意味着用户做服务器域名解析时，解析得到的IP其实是负载均衡的IP，而不是服务器的IP，这样有一个好处是，当新加入/移走服务器时，仅仅需要修改负载均衡的服务器列表，而不会影响现有的服务。
    - 需要有一个负载均衡设备来分发用户请求，将用户请求分发到空闲的服务器上
    - 服务器返回自己的服务到负载均衡设备
    - 负载均衡将服务器的服务返回用户

##### 网卡/防火墙，内核的TCP/IP协议栈
##### TCP/IP
##### 请求报文
##### 服务器处理
##### 响应报文

### 浏览器渲染


  [1]: 1.png
  [2]: 2.png